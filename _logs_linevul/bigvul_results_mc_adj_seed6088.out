[2023-11-15 20:54:50,938] [INFO] [real_accelerator.py:158:get_accelerator] Setting ds_accelerator to cuda (auto detect)
language_dict:  {'Python': 1, 'TypeScript': 2, 'Java': 3, 'CS': 4, 'CCPP': 5, 'JavaScript': 6}
language_dict:  {'Python': 1, 'TypeScript': 2, 'Java': 3, 'CS': 4, 'CCPP': 5, 'JavaScript': 6}
label_freq {0: 169462, 1: 787, 2: 157, 3: 816, 4: 313, 5: 6251, 6: 3008}
(22599, 7) (22599,)
(22599, 7) (22599,)
(22599, 7) (22599,)
(22599, 7) (22599,)
(22599, 7) (22599,)
(22599, 7) (22599,)
(22599, 7) (22599,)
(22599, 7) (22599,)
(22599, 7) (22599,)
(22599, 7) (22599,)
language_dict:  {'Python': 1, 'TypeScript': 2, 'Java': 3, 'CS': 4, 'CCPP': 5, 'JavaScript': 6}
best_threshold for Python:  0.9984
best_f1 for Python:  0.9286
best_recall:  0.8966
best_precision:  0.963
***** Python Test results *****
{'Python_accuracy': 0.9895977808599168, 'Python_ap': 0.8954528441567621, 'Python_recall': array([0.99557196, 0.89655172]), 'Python_precision': array([0.99337261, 0.92857143]), 'Python_f1': array([0.99447107, 0.9122807 ]), 'Python_threshold': 0.9984, 'Python_mcc': 0.9069112996515273, 'Python_cm': array([[1349,    6],
       [   9,   78]])}
best_threshold for TypeScript:  0.0748
best_f1 for TypeScript:  0.4103
best_recall:  0.5333
best_precision:  0.3333
***** TypeScript Test results *****
{'TypeScript_accuracy': 0.9442231075697212, 'TypeScript_ap': 0.35185792003697597, 'TypeScript_recall': array([1.        , 0.06666667]), 'TypeScript_precision': array([0.944, 1.   ]), 'TypeScript_f1': array([0.97119342, 0.125     ]), 'TypeScript_threshold': 0.0748, 'TypeScript_mcc': 0.2508651696296904, 'TypeScript_cm': array([[236,   0],
       [ 14,   1]])}
best_threshold for Java:  0.0811
best_f1 for Java:  0.3907
best_recall:  0.4286
best_precision:  0.359
***** Java Test results *****
{'Java_accuracy': 0.939568345323741, 'Java_ap': 0.39511069889789985, 'Java_recall': array([0.99458204, 0.21428571]), 'Java_precision': array([0.94346549, 0.75      ]), 'Java_f1': array([0.96834966, 0.33333333]), 'Java_threshold': 0.0811, 'Java_mcc': 0.38058189958461947, 'Java_cm': array([[1285,    7],
       [  77,   21]])}
best_threshold for CS:  0.427
best_f1 for CS:  0.6947
best_recall:  0.5893
best_precision:  0.8462
***** CS Test results *****
{'CS_accuracy': 0.8669527896995708, 'CS_ap': 0.7698181847253776, 'CS_recall': array([0.96610169, 0.55357143]), 'CS_precision': array([0.87244898, 0.83783784]), 'CS_f1': array([0.91689008, 0.66666667]), 'CS_threshold': 0.427, 'CS_mcc': 0.6075499724179849, 'CS_cm': array([[171,   6],
       [ 25,  31]])}
best_threshold for CCPP:  0.0506
best_f1 for CCPP:  0.3237
best_recall:  0.398
best_precision:  0.2728
***** CCPP Test results *****
{'CCPP_accuracy': 0.9517380812626361, 'CCPP_ap': 0.3354352785913742, 'CCPP_recall': array([0.99820863, 0.12820513]), 'CCPP_precision': array([0.9530325 , 0.80152672]), 'CCPP_f1': array([0.97509759, 0.22105263]), 'CCPP_threshold': 0.0506, 'CCPP_mcc': 0.3088473134693392, 'CCPP_cm': array([[14488,    26],
       [  714,   105]])}
best_threshold for JavaScript:  0.1475
best_f1 for JavaScript:  0.5013
best_recall:  0.5337
best_precision:  0.4726
***** JavaScript Test results *****
{'JavaScript_accuracy': 0.9210126582278481, 'JavaScript_ap': 0.5377977970063009, 'JavaScript_recall': array([0.98602962, 0.29380054]), 'JavaScript_precision': array([0.93088895, 0.68553459]), 'JavaScript_f1': array([0.95766621, 0.41132075]), 'JavaScript_threshold': 0.1475, 'JavaScript_mcc': 0.415323843740042, 'JavaScript_cm': array([[3529,   50],
       [ 262,  109]])}
+------------+---------------------+---------------------+--------------------+---------------------+
|  Language  |          AP         |          F1         |     Precision      |        Recall       |
+------------+---------------------+---------------------+--------------------+---------------------+
|   Python   |  0.8739749774193413 |  0.9176470588235294 | 0.9397590361445783 |  0.896551724137931  |
| TypeScript |  0.2971353226348586 | 0.11764705882352941 |        0.5         | 0.06666666666666667 |
|    Java    | 0.39368229995272114 |  0.3333333333333333 |        0.75        | 0.21428571428571427 |
|     CS     |  0.7495413524257327 |  0.6666666666666666 | 0.8378378378378378 |  0.5535714285714286 |
|    CCPP    |  0.3341186192899938 | 0.22058823529411764 | 0.7894736842105263 |  0.1282051282051282 |
| JavaScript |  0.5323323710984326 |  0.4060721062618595 | 0.6858974358974359 |  0.2884097035040431 |
+------------+---------------------+---------------------+--------------------+---------------------+
22599 22599 22599 22599
