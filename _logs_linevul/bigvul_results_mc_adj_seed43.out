[2023-11-15 11:41:39,777] [INFO] [real_accelerator.py:158:get_accelerator] Setting ds_accelerator to cuda (auto detect)
language_dict:  {'Python': 1, 'TypeScript': 2, 'Java': 3, 'CS': 4, 'CCPP': 5, 'JavaScript': 6}
language_dict:  {'Python': 1, 'TypeScript': 2, 'Java': 3, 'CS': 4, 'CCPP': 5, 'JavaScript': 6}
label_freq {0: 169523, 1: 782, 2: 156, 3: 795, 4: 311, 5: 6281, 6: 2946}
(22599, 7) (22599,)
(22599, 7) (22599,)
(22599, 7) (22599,)
(22599, 7) (22599,)
(22599, 7) (22599,)
(22599, 7) (22599,)
(22599, 7) (22599,)
(22599, 7) (22599,)
(22599, 7) (22599,)
(22599, 7) (22599,)
language_dict:  {'Python': 1, 'TypeScript': 2, 'Java': 3, 'CS': 4, 'CCPP': 5, 'JavaScript': 6}
best_threshold for Python:  0.5431
best_f1 for Python:  0.9064
best_recall:  0.8288
best_precision:  1.0
***** Python Test results *****
{'Python_accuracy': 0.987012987012987, 'Python_ap': 0.8807645873655421, 'Python_recall': array([1.        , 0.82882883]), 'Python_precision': array([0.9861415, 1.       ]), 'Python_f1': array([0.9930224 , 0.90640394]), 'Python_threshold': 0.5431, 'Python_mcc': 0.9040699677682066, 'Python_cm': array([[1352,    0],
       [  19,   92]])}
best_threshold for TypeScript:  0.0466
best_f1 for TypeScript:  0.3333
best_recall:  0.5455
best_precision:  0.24
***** TypeScript Test results *****
{'TypeScript_accuracy': 0.9533898305084746, 'TypeScript_ap': 0.2379128167158707, 'TypeScript_recall': array([1., 0.]), 'TypeScript_precision': array([0.95338983, 0.        ]), 'TypeScript_f1': array([0.97613883, 0.        ]), 'TypeScript_threshold': 0.0466, 'TypeScript_mcc': 0.0, 'TypeScript_cm': array([[225,   0],
       [ 11,   0]])}
best_threshold for Java:  0.0656
best_f1 for Java:  0.4039
best_recall:  0.41
best_precision:  0.3981
***** Java Test results *****
{'Java_accuracy': 0.9399021663172606, 'Java_ap': 0.4165196766632882, 'Java_recall': array([0.99849737, 0.16      ]), 'Java_precision': array([0.94055202, 0.88888889]), 'Java_f1': array([0.96865889, 0.27118644]), 'Java_threshold': 0.0656, 'Java_mcc': 0.36257992564637603, 'Java_cm': array([[1329,    2],
       [  84,   16]])}
best_threshold for CS:  0.0606
best_f1 for CS:  0.7434
best_recall:  0.7
best_precision:  0.7925
***** CS Test results *****
{'CS_accuracy': 0.8508771929824561, 'CS_ap': 0.8283537030552073, 'CS_recall': array([1.        , 0.43333333]), 'CS_precision': array([0.83168317, 1.        ]), 'CS_f1': array([0.90810811, 0.60465116]), 'CS_threshold': 0.0606, 'CS_mcc': 0.6003299422850408, 'CS_cm': array([[168,   0],
       [ 34,  26]])}
best_threshold for CCPP:  0.0445
best_f1 for CCPP:  0.3078
best_recall:  0.3672
best_precision:  0.2649
***** CCPP Test results *****
{'CCPP_accuracy': 0.9552850820098933, 'CCPP_ap': 0.307135462780063, 'CCPP_recall': array([0.99890523, 0.10413885]), 'CCPP_precision': array([0.95605763, 0.82978723]), 'CCPP_f1': array([0.97701188, 0.18505338]), 'CCPP_threshold': 0.0445, 'CCPP_mcc': 0.284563992457427, 'CCPP_cm': array([[14599,    16],
       [  671,    78]])}
best_threshold for JavaScript:  0.1032
best_f1 for JavaScript:  0.4844
best_recall:  0.4824
best_precision:  0.4863
***** JavaScript Test results *****
{'JavaScript_accuracy': 0.9179778179004385, 'JavaScript_ap': 0.5096326096678752, 'JavaScript_recall': array([0.9854618 , 0.27642276]), 'JavaScript_precision': array([0.9283029 , 0.66666667]), 'JavaScript_f1': array([0.95602876, 0.3908046 ]), 'JavaScript_threshold': 0.1032, 'JavaScript_mcc': 0.3947319934754705, 'JavaScript_cm': array([[3457,   51],
       [ 267,  102]])}
+------------+---------------------+---------------------+--------------------+--------------------+
|  Language  |          AP         |          F1         |     Precision      |       Recall       |
+------------+---------------------+---------------------+--------------------+--------------------+
|   Python   |  0.8782130942285372 |  0.9064039408866995 |        1.0         | 0.8288288288288288 |
| TypeScript | 0.12830828170457662 |         0.0         |        0.0         |        0.0         |
|    Java    |  0.3970002187290853 | 0.21052631578947367 | 0.8571428571428571 |        0.12        |
|     CS     |  0.7997199398780732 |  0.5882352941176471 |        1.0         | 0.4166666666666667 |
|    CCPP    | 0.30831054194775565 |  0.1848341232227488 | 0.8210526315789474 | 0.1041388518024032 |
| JavaScript |  0.5029168416806808 |  0.3893129770992366 | 0.6580645161290323 | 0.2764227642276423 |
+------------+---------------------+---------------------+--------------------+--------------------+
22599 22599 22599 22599
