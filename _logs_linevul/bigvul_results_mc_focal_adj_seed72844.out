[2023-11-14 20:26:00,139] [INFO] [real_accelerator.py:158:get_accelerator] Setting ds_accelerator to cuda (auto detect)
language_dict:  {'Python': 1, 'TypeScript': 2, 'Java': 3, 'CS': 4, 'CCPP': 5, 'JavaScript': 6}
language_dict:  {'Python': 1, 'TypeScript': 2, 'Java': 3, 'CS': 4, 'CCPP': 5, 'JavaScript': 6}
label_freq {0: 169422, 1: 804, 2: 145, 3: 819, 4: 337, 5: 6290, 6: 2976}
(22599, 7) (22599,)
(22599, 7) (22599,)
(22599, 7) (22599,)
(22599, 7) (22599,)
(22599, 7) (22599,)
(22599, 7) (22599,)
(22599, 7) (22599,)
(22599, 7) (22599,)
(22599, 7) (22599,)
(22599, 7) (22599,)
language_dict:  {'Python': 1, 'TypeScript': 2, 'Java': 3, 'CS': 4, 'CCPP': 5, 'JavaScript': 6}
best_threshold for Python:  0.6702
best_f1 for Python:  0.9
best_recall:  0.8276
best_precision:  0.9863
***** Python Test results *****
{'Python_accuracy': 0.9875, 'Python_ap': 0.8939695019521036, 'Python_recall': array([0.99704361, 0.83908046]), 'Python_precision': array([0.98972854, 0.94805195]), 'Python_f1': array([0.99337261, 0.8902439 ]), 'Python_threshold': 0.6702, 'Python_mcc': 0.8854946838957056, 'Python_cm': array([[1349,    4],
       [  14,   73]])}
best_threshold for TypeScript:  0.187
best_f1 for TypeScript:  0.4918
best_recall:  0.625
best_precision:  0.4054
***** TypeScript Test results *****
{'TypeScript_accuracy': 0.9227642276422764, 'TypeScript_ap': 0.4633738530541964, 'TypeScript_recall': array([1.        , 0.20833333]), 'TypeScript_precision': array([0.92116183, 1.        ]), 'TypeScript_f1': array([0.95896328, 0.34482759]), 'TypeScript_threshold': 0.187, 'TypeScript_mcc': 0.43807386784987085, 'TypeScript_cm': array([[222,   0],
       [ 19,   5]])}
best_threshold for Java:  0.2889
best_f1 for Java:  0.3333
best_recall:  0.5294
best_precision:  0.2432
***** Java Test results *****
{'Java_accuracy': 0.9216909216909217, 'Java_ap': 0.3452705907174274, 'Java_recall': array([0.96539028, 0.22352941]), 'Java_precision': array([0.95206972, 0.28787879]), 'Java_f1': array([0.95868373, 0.25165563]), 'Java_threshold': 0.2889, 'Java_mcc': 0.21291077355620752, 'Java_cm': array([[1311,   47],
       [  66,   19]])}
best_threshold for CS:  0.2098
best_f1 for CS:  0.6286
best_recall:  0.6471
best_precision:  0.6111
***** CS Test results *****
{'CS_accuracy': 0.8787878787878788, 'CS_ap': 0.6386565704547731, 'CS_recall': array([0.95731707, 0.5       ]), 'CS_precision': array([0.90229885, 0.70833333]), 'CS_f1': array([0.92899408, 0.5862069 ]), 'CS_threshold': 0.2098, 'CS_mcc': 0.5284434909511891, 'CS_cm': array([[157,   7],
       [ 17,  17]])}
best_threshold for CCPP:  0.2606
best_f1 for CCPP:  0.3455
best_recall:  0.4153
best_precision:  0.2959
***** CCPP Test results *****
{'CCPP_accuracy': 0.9534898848630716, 'CCPP_ap': 0.35140461361767583, 'CCPP_recall': array([0.99616438, 0.14747736]), 'CCPP_precision': array([0.95665329, 0.67058824]), 'CCPP_f1': array([0.97600913, 0.24178155]), 'CCPP_threshold': 0.2606, 'CCPP_mcc': 0.30016340085913135, 'CCPP_cm': array([[14544,    56],
       [  659,   114]])}
best_threshold for JavaScript:  0.1025
best_f1 for JavaScript:  0.4643
best_recall:  0.671
best_precision:  0.355
***** JavaScript Test results *****
{'JavaScript_accuracy': 0.9158974358974359, 'JavaScript_ap': 0.5055445049678413, 'JavaScript_recall': array([0.987205  , 0.26109661]), 'JavaScript_precision': array([0.92463382, 0.68965517]), 'JavaScript_f1': array([0.95489549, 0.37878788]), 'JavaScript_threshold': 0.1025, 'JavaScript_mcc': 0.39054954387038826, 'JavaScript_cm': array([[3472,   45],
       [ 283,  100]])}
+------------+---------------------+---------------------+--------------------+---------------------+
|  Language  |          AP         |          F1         |     Precision      |        Recall       |
+------------+---------------------+---------------------+--------------------+---------------------+
|   Python   |  0.8920815874032796 |  0.8902439024390243 | 0.948051948051948  |  0.8390804597701149 |
| TypeScript | 0.39416662004946446 |  0.2222222222222222 |        1.0         |        0.125        |
|    Java    | 0.33993515592291146 |  0.2432432432432432 | 0.2857142857142857 | 0.21176470588235294 |
|     CS     |  0.6500171588796744 |  0.5862068965517241 | 0.7083333333333334 |         0.5         |
|    CCPP    |  0.3517369919683724 | 0.24203821656050956 | 0.6745562130177515 | 0.14747736093143596 |
| JavaScript |  0.5046110001780547 | 0.37878787878787884 | 0.6896551724137931 | 0.26109660574412535 |
+------------+---------------------+---------------------+--------------------+---------------------+
22600 22600 22600 22600
